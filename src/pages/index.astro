---
import { getCollection } from "astro:content";

import Layout from "@/layouts/Layout.astro";
import SocialLinks from "@/components/SocialLinks.astro";
import PostCard from "@/components/PostCard.astro";
import Link from "@/components/shared/Link.astro";
import convertAsteriskToStrongTag from "@/utils/convertAsteriskToStrongTag";

import presentation from "@/data/presentation";

import Splide from "@/components/Splide.astro";
import Container from "@/components/Container.astro";

const posts = await getCollection("posts");
---

<Layout>
  <main class="flex flex-col gap-20">

    <article class="flex flex-col gap-8" transition:name="myArticle">
      <Container>
        <div>
          <h1>{presentation.title}</h1>
          <p
            set:html={convertAsteriskToStrongTag(presentation.description)}
          />
          <SocialLinks />
        </div>
      </Container>
    </article>


    <Splide />

    <article class="flex flex-col gap-8">
      <Container>
        <header class="flex w-full flex-row justify-between gap-2">
          <h2 class="text-lg text-neutral-100">Latest posts</h2>
          <Link
            href="/posts"
            label="See all posts"
            isUnderline
            target="_self"
          />
        </header>
        {posts.length === 0 && <p>Soon, stay connected ðŸ‘€...</p>}

        <section
          class="flex flex-col gap-4 md:flex-row md:flex-wrap"
          aria-label="Latest blog posts"
        >
          {
            posts.length !== 0 &&
              posts
                .slice(0, 2)
                .map((post) => (
                  <PostCard
                    publishedAt={post.data.publishedAt}
                    title={post.data.title}
                    description={post.data.description}
                    slug={post.slug}
                  />
                ))
          }
        </section>
      </Container>
    </article>


  </main>
</Layout>
